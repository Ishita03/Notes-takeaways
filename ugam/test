 shopresult_id                               STRING COMMENT '',
    tcin                                        STRING COMMENT '',
    amazon_best_seller_ranking                  STRING COMMENT '',
    cmpt_category                               STRING COMMENT '',
    cmpt_category_path_breadcrumb               STRING COMMENT '',
    cmpt_fastest_delivery_date_lead_time_days   STRING COMMENT '',
    cmpt_fastest_edd                            STRING COMMENT '',
    cmpt_final_price                            DOUBLE COMMENT '',
    cmpt_markdown_price                         DOUBLE COMMENT '',
    cmpt_other_seller_information               STRING COMMENT '',
    cmpt_product_average_rating                 STRING COMMENT '',
    cmpt_product_brand                          STRING COMMENT '',
    cmpt_product_canonical_url                  STRING COMMENT '',
    cmpt_product_color                          STRING COMMENT '',
    cmpt_product_description                    STRING COMMENT '',
    cmpt_product_dimensions                     STRING COMMENT '',
    cmpt_product_features                       STRING COMMENT '',
    cmpt_product_id                             STRING COMMENT '',
    cmpt_product_image_primary_url              STRING COMMENT '',
    cmpt_product_image_url_small_thumbnail      STRING COMMENT '',
    cmpt_product_images_count                   STRING COMMENT '',
    cmpt_product_material                       STRING COMMENT '',
    cmpt_product_meta_description               STRING COMMENT '',
    cmpt_product_mpn                            STRING COMMENT '',
    cmpt_product_pack_quantity                  STRING COMMENT '',
    cmpt_product_page_title                     STRING COMMENT '',
    cmpt_product_reviews_count                  STRING COMMENT '',
    cmpt_product_saleable_quantity              STRING COMMENT '',
    cmpt_product_size_chart                     STRING COMMENT '',
    cmpt_product_sku_variant                    STRING COMMENT '',
    cmpt_product_technical_details              STRING COMMENT '',
    cmpt_product_title                          STRING COMMENT '',
    cmpt_product_upc                            STRING COMMENT '',
    cmpt_product_url                            STRING COMMENT '',
    cmpt_product_variations                     STRING COMMENT '',
    cmpt_product_video_links                    STRING COMMENT '',
    cmpt_product_videos_count                   STRING COMMENT '',
    cmpt_product_weight                         STRING COMMENT '',
    cmpt_promotion_discount                     DOUBLE COMMENT '',
    cmpt_promotional_message                    STRING COMMENT '',
    cmpt_regular_price                          DOUBLE COMMENT '',
    cmpt_regular_price_range                    STRING COMMENT '',
    cmpt_retailer_name                          STRING COMMENT '',
    cmpt_seller_name_sold_by                    STRING COMMENT '',
    cmpt_ship_by                                STRING COMMENT '',
    cmpt_shipping_and_delivery                  STRING COMMENT '',
    cmpt_standard_delivery_date_lead_time_days  STRING COMMENT '',
    cmpt_standard_edd                           STRING COMMENT '',
    cmpt_stock_availability_status              STRING COMMENT '',
    cmpt_stock_availability_text                STRING COMMENT '',
    cmpt_store_name_site                        STRING COMMENT '',
    cmpt_zipcode                                STRING COMMENT '',
    created_ts                                  STRING COMMENT '',
    is_refurbished                              BOOLEAN COMMENT '',
    sherlock_confidence_reason                  STRING COMMENT '',
    sherlock_confidence_score                   STRING COMMENT '',
    sherlock_high_confidence_fail               BOOLEAN COMMENT '',
    sherlock_high_confidence_pass               BOOLEAN COMMENT '',
    tgt_brand                               STRING COMMENT '',
    tgt_brand_id                              STRING COMMENT '',    
    tgt_class_id                                STRING COMMENT '',
    tgt_class_name                              STRING COMMENT '',
    tgt_department_id                           STRING COMMENT '',
    tgt_department_name                         STRING COMMENT '',
    tgt_division_id                             STRING COMMENT '',
    tgt_division_name                           STRING COMMENT '',
    tgt_dpci                                    STRING COMMENT '',
    tgt_group_id                                STRING COMMENT '',
    tgt_group_name                              STRING COMMENT '',
    tgt_item_site_published                     BOOLEAN COMMENT '',
    tgt_title                                   STRING COMMENT '',
    tgt_upc                                     STRING COMMENT '',
    ugam_crawl_ts                               STRING COMMENT '',
    ugam_match_confidence_score                 STRING COMMENT '',
    ugam_match_status                           STRING COMMENT '',
    audit_status                                STRING COMMENT '',
    audit_comments                                STRING COMMENT ''


    shopresult_id                               ,
    tcin                                        ,
    amazon_best_seller_ranking                  ,
    cmpt_category                               ,
    cmpt_category_path_breadcrumb               ,
    cmpt_fastest_delivery_date_lead_time_days   ,
    cmpt_fastest_edd                            ,
    cmpt_final_price                            ,
    cmpt_markdown_price                         ,
    cmpt_other_seller_information               ,
    cmpt_product_average_rating                 ,
    cmpt_product_brand                          ,
    cmpt_product_canonical_url                  ,
    cmpt_product_color                          ,
    cmpt_product_description                    ,
    cmpt_product_dimensions                     ,
    cmpt_product_features                       ,
    cmpt_product_id                             ,
    cmpt_product_image_primary_url              ,
    cmpt_product_image_url_small_thumbnail      ,
    cmpt_product_images_count                   ,
    cmpt_product_material                       ,
    cmpt_product_meta_description               ,
    cmpt_product_mpn                            ,
    cmpt_product_pack_quantity                  ,
    cmpt_product_page_title                     ,
    cmpt_product_reviews_count                  ,
    cmpt_product_saleable_quantity              ,
    cmpt_product_size_chart                     ,
    cmpt_product_sku_variant                    ,
    cmpt_product_technical_details              ,
    cmpt_product_title                          ,
    cmpt_product_upc                            ,
    cmpt_product_url                            ,
    cmpt_product_variations                     ,
    cmpt_product_video_links                    ,
    cmpt_product_videos_count                   ,
    cmpt_product_weight                         ,
    cmpt_promotion_discount                     ,
    cmpt_promotional_message                    ,
    cmpt_regular_price                          ,
    cmpt_regular_price_range                    ,
    cmpt_retailer_name                          ,
    cmpt_seller_name_sold_by                    ,
    cmpt_ship_by                                ,
    cmpt_shipping_and_delivery                  ,
    cmpt_standard_delivery_date_lead_time_days  ,
    cmpt_standard_edd                           ,
    cmpt_stock_availability_status              ,
    cmpt_stock_availability_text                ,
    cmpt_store_name_site                        ,
    cmpt_zipcode                                ,
    created_ts                                  ,
    is_refurbished                              ,
    sherlock_confidence_reason                  ,
    sherlock_confidence_score                   ,
    sherlock_high_confidence_fail               ,
    sherlock_high_confidence_pass               ,
    tgt_brand                               ,
    tgt_brand_id                              ,    
    tgt_class_id                                ,
    tgt_class_name                              ,
    tgt_department_id                           ,
    tgt_department_name                         ,
    tgt_division_id                             ,
    tgt_division_name                           ,
    tgt_dpci                                    ,
    tgt_group_id                                ,
    tgt_group_name                              ,
    null                     ,
    tgt_title                                   ,
    tgt_upc                                     ,
    ugam_crawl_ts                               ,
    ugam_match_confidence_score                 ,
    ugam_match_status                           ,
    audit_status                                ,
    audit_comments                                ,
    shop_week_end_d

    val reorderedColumns = Seq(
  "shopresult_id",
  "tcin",
  "amazon_best_seller_ranking",
  "cmpt_category",
  "cmpt_category_path_breadcrumb",
  "cmpt_fastest_delivery_date_lead_time_days",
  "cmpt_fastest_edd",
  "cmpt_final_price",
  "cmpt_markdown_price",
  "cmpt_other_seller_information",
  "cmpt_product_average_rating",
  "cmpt_product_brand",
  "cmpt_product_canonical_url",
  "cmpt_product_color",
  "cmpt_product_description",
  "cmpt_product_dimensions",
  "cmpt_product_features",
  "cmpt_product_id",
  "cmpt_product_image_primary_url",
  "cmpt_product_image_url_small_thumbnail",
  "cmpt_product_images_count",
  "cmpt_product_material",
  "cmpt_product_meta_description",
  "cmpt_product_mpn",
  "cmpt_product_pack_quantity",
  "cmpt_product_page_title",
  "cmpt_product_reviews_count",
  "cmpt_product_saleable_quantity",
  "cmpt_product_size_chart",
  "cmpt_product_sku_variant",
  "cmpt_product_technical_details",
  "cmpt_product_title",
  "cmpt_product_upc",
  "cmpt_product_url",
  "cmpt_product_variations",
  "cmpt_product_video_links",
  "cmpt_product_videos_count",
  "cmpt_product_weight",
  "cmpt_promotion_discount",
  "cmpt_promotional_message",
  "cmpt_regular_price",
  "cmpt_regular_price_range",
  "cmpt_retailer_name",
  "cmpt_seller_name_sold_by",
  "cmpt_ship_by",
  "cmpt_shipping_and_delivery",
  "cmpt_standard_delivery_date_lead_time_days",
  "cmpt_standard_edd",
  "cmpt_stock_availability_status",
  "cmpt_stock_availability_text",
  "cmpt_store_name_site",
  "cmpt_zipcode",
  "created_ts",
  "is_refurbished",
  "sherlock_confidence_reason",
  "sherlock_confidence_score",
  "sherlock_high_confidence_fail",
  "sherlock_high_confidence_pass",
  "tgt_brand",
  "tgt_brand_id",
  "tgt_class_id",
  "tgt_class_name",
  "tgt_department_id",
  "tgt_department_name",
  "tgt_division_id",
  "tgt_division_name",
  "tgt_dpci",
  "tgt_group_id",
  "tgt_group_name",
  "tgt_item_site_published", 
  "tgt_title",
  "tgt_upc",
  "ugam_crawl_ts",
  "ugam_match_confidence_score",
  "ugam_match_status",
  "audit_status",
  "audit_comments",
  "shop_week_end_d"
)

val reorderedDF = rename.select(reorderedColumns.map(col): _*)

val rename = deduplicatedDF.withColumn("shopresult_id", col("id")).withColumn("is_refurbished", col("refurbished"))

final.coalesce(10).write.mode("overwrite").format("orc").insertInto("stg_priceent_wrk.ugam_shopresults")